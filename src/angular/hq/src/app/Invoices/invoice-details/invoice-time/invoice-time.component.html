<div class="h-[calc(100dvh-106px)] fixed top-70 left-0 w-full flex flex-col">
  <div class="flex justify-between gap-[20px]">
    <div class="px-5">
      <h1 class="font-rajdhani font-semibold text-3xl">Invoice Details</h1>
      <div>
        <div class="flex flex-col xl:flex-row xl:justify-between xl:items-center">
          <div class="grid grid-flow-col gap-[30px] auto-cols-max pt-3">
            @if (invoice){
              <div class="text-gray-50">
                {{ invoice.invoiceNumber }}
              </div>
            }
            @if (currentClient; as client){
              <div class="text-gray-50">
                Client Email: {{ client.billingEmail || "None" }}
              </div>
              <div class="text-gray-50">
                Official Client Name - 
                <a
                    [routerLink]="['/clients', client.id]"
                    class="underline"
                    >{{ client.officialName }}</a
                  >
              </div>
            }
          </div>
    
        </div>
      </div>
      <div class="py-3">
        <a routerLink="/invoices" class="text-gray-50 underline">Invoice List</a>
      </div>
    </div>
    <div class="flex space-x-8 p-4">
      <div class="text-center text-white">
        <div class="text-xs text-right uppercase font-bold tracking-[.06em]">
          TOTAL HOURS
        </div>
        <p class="text-right">
          {{ invoice?.totalHours || "-" }}
          <!-- {{
            (staffDashboardService.time$ | async)?.hoursThisWeek?.toFixed(2) ||
              "-"
          }} -->
        </p>
      </div>
      <div class="text-center text-white">
        <div class="text-xs text-right uppercase font-bold tracking-[.06em]">
          BILLABLE HOURS
        </div>
        <p class="text-right">
          {{ invoice?.billableHours || "-" }}
          <!-- {{
            (staffDashboardService.time$ | async)?.hoursLastWeek?.toFixed(2) ||
              "-"
          }} -->
        </p>
      </div>
      <div class="text-center text-white">
        <div class="text-xs text-right uppercase font-bold tracking-[.06em]">
          ACCEPTED HOURS
        </div>
        <p class="text-right">
          {{ invoice?.acceptedHours || "-" }}
          <!-- {{
            (staffDashboardService.time$ | async)?.hoursThisMonth?.toFixed(2) ||
              "-"
          }} -->
        </p>
      </div>
      <div class="text-center text-white">
        <div class="text-xs text-right uppercase font-bold tracking-[.06em]">
          ACCEPTED BILLABLE HOURS
        </div>
        <p class="text-right">
          {{ invoice?.acceptedBillableHours || "-" }}
          <!-- {{
            (staffDashboardService.time$ | async)?.vacation?.toFixed(2) || "-"
          }} -->
        </p>
      </div>
    </div>
  </div>
  
  <div class="overflow-hidden flex-auto">
    <div class="grid gap-0 relative">
      <main
        class="flex flex-col bg-black-alt overflow-y-auto "
      >
        <div
          class="bg-black-alt border-steel-blue-600 border-t sticky top-0 flex h-[53px] z-50"
        >
          <div
            class="w-full flex flex-row border-b border-black justify-between pe-5"
          >
            <div class="flex pt-[23px]">
              <a
                href="#"
                routerLink="../details"
                class="w-full min-w-[107px] text-center whitespace-nowrap px-3 py-1 font-bold hover:border-gray-100"
                >Details</a
              >
              <a
                href="#"
                routerLink="./"
                routerLinkActive="border-gray-100"
                class="w-full min-w-[107px] text-center whitespace-nowrap px-3 py-1 font-bold border-b border-gray-100 hover:border-gray-100"
                >Time</a
              >
            </div>
          </div>
        </div>
      </main>
    </div>
    <hq-table [withPagination]="false" class="w-full border-spacing-0 border-separate">
      <thead>
        <tr class="sticky top-0 text-left">
          <th
            width="15px"
            style="padding:0px"
          ></th>
          <th
            width="30px"
          ></th>
          <th
          scope="col"
            width="120px"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 cursor-pointer whitespace-nowrap"
            [hq-sort-header]="sortColumn.StaffName"
            >
            Staff
          </th>
          <th
            width="120px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 cursor-pointer whitespace-nowrap"
            [hq-sort-header]="sortColumn.Date"
          >
            Date
          </th>
          <!-- <th
          width="150px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 whitespace-nowrap"
          >
            Client
          </th> -->
          <th
            width="40px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 cursor-pointer whitespace-nowrap"
            [hq-sort-header]="sortColumn.ChargeCode"
          >
            Chrg Code
          </th>
          <th
            width="210px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 whitespace-nowrap"
          >
            Project
          </th>
          <th
            width="130px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 whitespace-nowrap"
          >
            Activity/Task
          </th>
          <!-- <th
            width="40px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y py-3 whitespace-nowrap"
          >
            Billable
          </th> -->
          <th
            width="40px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 cursor-pointer whitespace-nowrap"
            [hq-sort-header]="sortColumn.Hours"
          >
            Hrs
          </th>
          <th
            width="80px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3"
          >
            Invoiced Hrs
          </th>
          <!-- <th
            width="80px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y py-3 whitespace-nowrap"
          >
            Invoice #
          </th> -->
          <th
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y px-3 py-3 whitespace-nowrap"
          >
            Description
          </th>
    
          <!-- <th
            width="40px"
            scope="col"
            class="bg-blue-900 border-steel-blue-600 border-y py-3 text-right pr-2 whitespace-nowrap"
            colspan="2"
          ></th> -->
        </tr>
      </thead>
      <tbody>
        <tr class="sticky top-0 bg-black-alt border-spacing-0 border-separate text-left">
          <td class="border-b border-black py-2 bg-gray-450"></td>
          <td class="border-y border-s border-white py-1 px-2">
            <div class="flex justify-center">
              @if ([HQRole.Executive, HQRole.Administrator] | inRole | async) {
                <input title="Select Entry" type="checkbox">
              }
            </div>
          </td>
          <td class="border-y border-white py-1 px-2">
            <input title="staff name" type="text" class="bg-blue-900 text-white placeholder-white border border-black px-1 w-24" placeholder="[activeStaff]">
          </td>
          <td class="border-y border-white py-1 px-2">
            <input title="date" type="date" class="bg-blue-900 text-white border border-black ps-1 w-24" placeholder="{{date}}">
          </td>
          <td class="border-y border-white py-1 px-2">
            <input title="charge code" type="text" class="bg-blue-900 text-gray-450 border border-black px-1 w-14" placeholder="Chrg">
          </td>
          <td class="border-y border-white py-1 px-2 text-left">
            <input title="project" type="text" class="bg-blue-900 text-gray-450 border border-black px-1" placeholder="Project">
          </td>
          <td class="border-y border-white py-1 px-2">
            <input title="activity/task" type="text" class="bg-blue-900 text-gray-450 border border-black px-1 w-28" placeholder="Activity">
          </td>
          <td class="border-y border-white py-1 px-2">
            <input title="hours" type="number" class="bg-blue-900 text-gray-450 border border-black px-1 w-12" placeholder="0">
          </td>
          <td class="border-y border-white py-1 px-2">
            <input title="invoiced hours" type="number" class="bg-blue-900 text-gray-450 border border-black px-1 w-12" placeholder="0">
          </td>
          <td class="border-e border-y border-white py-1 px-2">
            <input title="description" type="text" class="bg-blue-900 text-gray-450 border border-black px-1 w-full" placeholder="Description">
          </td>
        </tr>
        @for ((time of times$| async); track $index) {
          <tr class="even:bg-gray-850 odd:bg-black-alt">
            <td class="border-b border-black py-2 {{
              time.status === 1 ? 'bg-green-450' : 
              time.status === 2 ? 'bg-red-850' :
              time.status === 3 ? 'bg-yellow-550' :
              'bg-gray-450'
              }}
            "></td>
            <td class="border-b border-black py-2 pl-2">
                <div class="flex justify-center">
                  @if ([HQRole.Executive, HQRole.Administrator] | inRole | async) {
                    <input #time{{index}}Checkbox title="Select Entry" type="checkbox" (click)="updateTimeSelection(time, $index)">
                  }
                </div>
              </td>
            <td class="border-b px-3 border-black py-2">{{ time.staffName }}</td>
            <td class="border-b border-black px-3 py-2">{{ time.date }}</td>
            <td class="border-b px-3 border-black py-2">{{ time.chargeCode }}</td>
            <td class="border-b border-black px-3 py-2">{{ time.projectName }}</td>
            <td class="border-b px-3 border-black py-2">
              {{ time.activityName ?? time.task }}
            </td>
            <td class="border-b border-black px-3 py-2 text-right">
              {{ time.hours | number: "1.2-2" }}
            </td>
            <td class="border-b border-black px-2 py-2">
              <input title="invoiced hours" type="number" class="bg-blue-900 text-gray-450 border border-black px-1 w-12" placeholder="{{time.hoursApproved}}">
            </td>
            <!-- <td class="border-b border-black py-2">{{ time.invoiceNumber }}</td> -->
            <td class="border-b border-black px-3 py-2">{{ time.description }}</td>
          </tr>
        }
      </tbody>
    </hq-table>
  </div>
</div>